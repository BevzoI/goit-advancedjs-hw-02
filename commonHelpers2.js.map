{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-timer.js"],"sourcesContent":["// Описаний в документації\nimport flatpickr from 'flatpickr';\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'flatpickr/dist/flatpickr.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n/**\n * References Object\n *\n * @type {{ inputDateRef: HTMLElement | null; btnStartRef: HTMLElement | null; timerRef: HTMLElement | null; }}\n * @property {HTMLElement} inputDateRef - HTML Element Input where pick date\n * @property {HTMLElement} btnStartRef - HTML Element Button Start\n * @property {HTMLElement} timerRef -HTML Element where indicate timer\n *\n};\n */\nconst refs = {\n  inputDateRef: document.querySelector('#datetime-picker'),\n  btnStartRef: document.querySelector('[data-start]'),\n  timerRef: document.querySelector('.timer'),\n};\n\n/**\n * Initial time\n *\n * @type {number | null}\n *\n */\nlet timerMs = null;\n\n/**\n * Settings for iziToast\n *\n * @type {{ title: string; message: string; timeout: number; position: string; backgroundColor: string; }}\n * @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\n */\nconst settingsIziToast = {\n  title: 'X',\n  message: 'Please choose a date in the future',\n  timeout: 2000,\n  position: 'topCenter',\n  backgroundColor: 'red',\n};\n/**\n * Options for flatpickr\n *\n * @type {{ enableTime: boolean; time_24hr: boolean; defaultDate: string; minuteIncrement: number; onClose(selectedDates: string): func; }}\n * @description Read more about flatpickr options at https://flatpickr.js.org/\n *\n */\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  onClose(selectedDates) {\n    let dateDiff = selectedDates[0] - this.now;\n    if (dateDiff <= 0) {\n      iziToast.show();\n    } else {\n      timerMs = dateDiff;\n      changeDisabledStatus(refs.btnStartRef);\n    }\n  },\n};\n\n/**iziToast base settings */\niziToast.settings(settingsIziToast);\n/**Disabled start button */\nchangeDisabledStatus(refs.btnStartRef);\n/**flatpickr base settings */\nflatpickr(refs.inputDateRef, options);\n\n// Event listeners\n/**Start Button */\nrefs.btnStartRef.addEventListener('click', handleClickStart);\n\n// FUNCTIONS\n//----------------------------------------------\n/**\n * Handler click-event on start button. After click disabled input and disabled start button. Every 1 second change time\n *\n * @param {Event} e click-event\n */\nfunction handleClickStart(e) {\n  changeDisabledStatus(refs.inputDateRef);\n  changeDisabledStatus(refs.btnStartRef);\n  changeData(convertMs(timerMs));\n  let timerId = setInterval(() => {\n    timerMs -= 1000;\n    if (timerMs <= 1000) {\n      clearInterval(timerId);\n      changeDisabledStatus(refs.inputDateRef);\n    }\n    changeData(convertMs(timerMs));\n  }, 1000);\n}\n//----------------------------------------------\n\n/**\n * Converting input miliseconds to object with properties days, hours, minutes and seconds\n *\n * @param {number} ms\n * @returns {{ days: number; hours: number; minutes: number; seconds: number; }}\n */\nfunction convertMs(ms) {\n  // Number of milliseconds per unit of time\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  // Remaining days\n  const days = Math.floor(ms / day);\n  // Remaining hours\n  const hours = Math.floor((ms % day) / hour);\n  // Remaining minutes\n  const minutes = Math.floor(((ms % day) % hour) / minute);\n  // Remaining seconds\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n  return { days, hours, minutes, seconds };\n}\n//----------------------------------------------\n\n/**\n * Converting input value to string and if number less than 10 add before value symbol 0. If typeof value !== number function returns string \"XX\"\n *\n * @param {number} value\n * @returns {string}\n */\nfunction addLeadingZero(value) {\n  if (typeof value !== 'number') return 'XX';\n  const strValue = String(value);\n  return strValue.length > 1 ? strValue : strValue.padStart(2, '0');\n}\n\n//----------------------------------------------\n/**\n * Change disabled status in HTML element\n *\n * @param {HTMLElement} element\n */\nfunction changeDisabledStatus(element) {\n  element.disabled = !element.disabled;\n}\n\n//----------------------------------------------\n/**\n * Change data in HTML elements where indicate timer\n *\n * @param {object} data\n */\nfunction changeData(data) {\n  // all spans from html with class value\n  const timerSpanArray = Array.from(refs.timerRef.children)\n    .flatMap(el => [...el.children])\n    .filter(el => el.classList.contains('value'));\n  // find needed span and change text from data\n  Object.keys(data).forEach(el => {\n    timerSpanArray.find(span =>\n      Object.keys(span.dataset).includes(el)\n    ).textContent = addLeadingZero(data[el]);\n  });\n}"],"names":["refs","timerMs","settingsIziToast","options","selectedDates","dateDiff","iziToast","changeDisabledStatus","flatpickr","handleClickStart","e","changeData","convertMs","timerId","ms","days","hours","minutes","seconds","addLeadingZero","value","strValue","element","data","timerSpanArray","el","span"],"mappings":"+IAiBA,MAAMA,EAAO,CACX,aAAc,SAAS,cAAc,kBAAkB,EACvD,YAAa,SAAS,cAAc,cAAc,EAClD,SAAU,SAAS,cAAc,QAAQ,CAC3C,EAQA,IAAIC,EAAU,KAQd,MAAMC,EAAmB,CACvB,MAAO,IACP,QAAS,qCACT,QAAS,IACT,SAAU,YACV,gBAAiB,KACnB,EAQMC,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAQC,EAAe,CACrB,IAAIC,EAAWD,EAAc,CAAC,EAAI,KAAK,IACnCC,GAAY,EACdC,EAAS,KAAI,GAEbL,EAAUI,EACVE,EAAqBP,EAAK,WAAW,EAExC,CACH,EAGAM,EAAS,SAASJ,CAAgB,EAElCK,EAAqBP,EAAK,WAAW,EAErCQ,EAAUR,EAAK,aAAcG,CAAO,EAIpCH,EAAK,YAAY,iBAAiB,QAASS,CAAgB,EAS3D,SAASA,EAAiBC,EAAG,CAC3BH,EAAqBP,EAAK,YAAY,EACtCO,EAAqBP,EAAK,WAAW,EACrCW,EAAWC,EAAUX,CAAO,CAAC,EAC7B,IAAIY,EAAU,YAAY,IAAM,CAC9BZ,GAAW,IACPA,GAAW,MACb,cAAcY,CAAO,EACrBN,EAAqBP,EAAK,YAAY,GAExCW,EAAWC,EAAUX,CAAO,CAAC,CAC9B,EAAE,GAAI,CACT,CASA,SAASW,EAAUE,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CASA,SAASC,EAAeC,EAAO,CAC7B,GAAI,OAAOA,GAAU,SAAU,MAAO,KACtC,MAAMC,EAAW,OAAOD,CAAK,EAC7B,OAAOC,EAAS,OAAS,EAAIA,EAAWA,EAAS,SAAS,EAAG,GAAG,CAClE,CAQA,SAASd,EAAqBe,EAAS,CACrCA,EAAQ,SAAW,CAACA,EAAQ,QAC9B,CAQA,SAASX,EAAWY,EAAM,CAExB,MAAMC,EAAiB,MAAM,KAAKxB,EAAK,SAAS,QAAQ,EACrD,QAAQyB,GAAM,CAAC,GAAGA,EAAG,QAAQ,CAAC,EAC9B,OAAOA,GAAMA,EAAG,UAAU,SAAS,OAAO,CAAC,EAE9C,OAAO,KAAKF,CAAI,EAAE,QAAQE,GAAM,CAC9BD,EAAe,KAAKE,GAClB,OAAO,KAAKA,EAAK,OAAO,EAAE,SAASD,CAAE,CACtC,EAAC,YAAcN,EAAeI,EAAKE,CAAE,CAAC,CAC3C,CAAG,CACH"}